<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beelze Apps - Alternative App Store</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2196f3">
    <link rel="icon" href="https://i.postimg.cc/L5PsZ2vw/Screenshot-20260122-204929-com-google-android-youtube-edit-128026005216681.jpg" type="image/png">

    <script src="https://3nbf4.com/act/files/tag.min.js?z=10579195" data-cfasync="false" async></script>

    <script src="https://3nbf4.com/act/files/tag.min.js?z=10579194" data-cfasync="false" async></script>


    <script src="https://quge5.com/88/tag.min.js" data-zone="209064" async data-cfasync="false"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f9fafb; color: #111827; min-height: 100vh; }
        
        .header { background: white; padding: 16px; border-bottom: 1px solid #e5e7eb; position: sticky; top: 0; z-index: 50; }
        .header-content { max-width: 768px; margin: 0 auto; }
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
        .logo { font-size: 24px; font-weight: bold; transition: all 0.3s; }
        .logo-sub { font-size: 12px; color: #6b7280; }
        .btn { display: inline-flex; align-items: center; gap: 8px; padding: 10px 16px; background: #059669; color: white; border: none; border-radius: 12px; font-weight: 500; cursor: pointer; font-size: 14px; transition: all 0.2s; }
        .btn:hover { background: #047857; transform: scale(1.02); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .btn-outline { background: white; color: #374151; border: 1px solid #e5e7eb; }
        .btn-outline:hover { background: #f9fafb; }
        .btn-danger { background: #ef4444; }
        .btn-danger:hover { background: #dc2626; }
        
        .search-box { position: relative; }
        .search-box svg { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); width: 20px; height: 20px; color: #9ca3af; }
        .search-input { width: 100%; padding: 14px 16px 14px 48px; background: #f3f4f6; border: none; border-radius: 16px; font-size: 16px; outline: none; }
        .search-input:focus { background: white; box-shadow: 0 0 0 2px #059669; }
        
        .categories { display: flex; gap: 8px; padding: 16px; max-width: 768px; margin: 0 auto; overflow-x: auto; }
        .cat-btn { display: flex; align-items: center; gap: 8px; padding: 10px 16px; background: #f3f4f6; border: none; border-radius: 50px; font-weight: 500; font-size: 14px; color: #4b5563; cursor: pointer; white-space: nowrap; transition: all 0.2s; }
        .cat-btn.active { background: #059669; color: white; box-shadow: 0 4px 12px rgba(5,150,105,0.3); }
        .cat-btn svg { width: 16px; height: 16px; }
        
        .main { max-width: 768px; margin: 0 auto; padding: 0 16px 100px; }
        
        .featured { background: linear-gradient(135deg, #059669, #0d9488); border-radius: 24px; padding: 24px; color: white; margin-bottom: 24px; box-shadow: 0 10px 40px rgba(5,150,105,0.3); cursor: pointer; transition: transform 0.2s; }
        .featured:hover { transform: translateY(-4px); }
        .featured-content { display: flex; gap: 20px; }
        .featured-icon { width: 96px; height: 96px; border-radius: 20px; object-fit: cover; box-shadow: 0 10px 30px rgba(0,0,0,0.2); background: rgba(255,255,255,0.2); }
        .featured-badge { display: inline-block; padding: 4px 12px; background: rgba(255,255,255,0.2); border-radius: 50px; font-size: 12px; margin-bottom: 8px; }
        .featured-title { font-size: 20px; font-weight: bold; margin-bottom: 4px; }
        .featured-desc { color: rgba(255,255,255,0.8); font-size: 14px; margin-bottom: 12px; }
        .featured-stats { display: flex; align-items: center; gap: 16px; font-size: 14px; }
        
        .app-card { background: white; border-radius: 16px; padding: 16px; margin-bottom: 12px; border: 1px solid #e5e7eb; display: flex; gap: 16px; cursor: pointer; transition: all 0.2s; }
        .app-card:hover { box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-color: #a7f3d0; transform: translateY(-2px); }
        .app-icon-wrap { position: relative; flex-shrink: 0; }
        .app-icon { width: 80px; height: 80px; border-radius: 16px; object-fit: cover; box-shadow: 0 4px 12px rgba(0,0,0,0.1); background: linear-gradient(135deg, #e5e7eb, #d1d5db); }
        .app-badge { position: absolute; bottom: -4px; right: -4px; padding: 6px; background: #d1fae5; border-radius: 8px; }
        .app-badge svg { width: 12px; height: 12px; color: #059669; }
        .app-info { flex: 1; min-width: 0; }
        .app-title { font-weight: 600; color: #111827; margin-bottom: 2px; }
        .app-author { font-size: 14px; color: #6b7280; margin-bottom: 4px; }
        .app-desc { font-size: 12px; color: #9ca3af; margin-bottom: 8px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .app-stats { display: flex; align-items: center; gap: 12px; font-size: 12px; color: #6b7280; }
        .app-stats svg { width: 12px; height: 12px; }
        
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; border-top: 1px solid #e5e7eb; padding: 8px 0; z-index: 50; }
        .nav-content { max-width: 768px; margin: 0 auto; display: flex; justify-content: space-around; }
        .nav-item { display: flex; flex-direction: column; align-items: center; gap: 4px; padding: 8px 24px; color: #6b7280; text-decoration: none; font-size: 12px; font-weight: 500; cursor: pointer; border: none; background: none; transition: color 0.2s; }
        .nav-item.active { color: #059669; }
        .nav-item svg { width: 24px; height: 24px; }
        .nav-avatar { width: 24px; height: 24px; background: linear-gradient(135deg, #34d399, #14b8a6); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 10px; font-weight: bold; }
        
        .empty { text-align: center; padding: 60px 20px; }
        .empty-icon { width: 80px; height: 80px; background: #f3f4f6; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; }
        .empty-icon svg { width: 32px; height: 32px; color: #9ca3af; }
        .empty h3 { font-size: 18px; font-weight: 600; margin-bottom: 8px; }
        .empty p { color: #6b7280; margin-bottom: 24px; }
        
        .detail-card { background: white; border-radius: 24px; padding: 24px; margin-bottom: 24px; border: 1px solid #e5e7eb; }
        .detail-top { display: flex; gap: 20px; margin-bottom: 24px; }
        .detail-icon { width: 112px; height: 112px; border-radius: 24px; object-fit: cover; box-shadow: 0 10px 30px rgba(0,0,0,0.15); background: linear-gradient(135deg, #e5e7eb, #d1d5db); }
        .detail-title { font-size: 24px; font-weight: bold; margin-bottom: 4px; }
        .detail-author { color: #059669; font-weight: 500; margin-bottom: 8px; }
        .detail-cat { display: inline-flex; align-items: center; gap: 4px; padding: 4px 12px; background: #d1fae5; color: #059669; border-radius: 50px; font-size: 12px; font-weight: 500; }
        .detail-cat svg { width: 12px; height: 12px; }
        .detail-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; padding: 24px 0; border-top: 1px solid #e5e7eb; border-bottom: 1px solid #e5e7eb; margin: 24px 0; }
        .stat { text-align: center; }
        .stat-val { font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 4px; }
        .stat-val svg { width: 16px; height: 16px; }
        .stat-label { font-size: 12px; color: #6b7280; margin-top: 4px; }
        .download-btn { width: 100%; padding: 18px; background: #059669; color: white; border: none; border-radius: 16px; font-size: 18px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 10px 30px rgba(5,150,105,0.3); transition: all 0.2s; }
        .download-btn:hover { background: #047857; transform: scale(1.02); }
        .download-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        .download-btn svg { width: 20px; height: 20px; }
        
        .screenshots { display: flex; gap: 12px; overflow-x: auto; padding-bottom: 8px; margin-bottom: 24px; }
        .screenshot { height: 280px; width: auto; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); flex-shrink: 0; background: #f3f4f6; cursor: pointer; transition: transform 0.2s; }
        .screenshot:hover { transform: scale(1.05); }
        
        .section { background: white; border-radius: 24px; padding: 24px; margin-bottom: 24px; border: 1px solid #e5e7eb; }
        .section-title { font-size: 18px; font-weight: 600; margin-bottom: 12px; }
        .section-text { color: #4b5563; line-height: 1.6; white-space: pre-wrap; }
        
        .reviews-section { background: white; border-radius: 24px; padding: 24px; margin-bottom: 24px; border: 1px solid #e5e7eb; }
        .review-card { padding: 16px; border-bottom: 1px solid #e5e7eb; }
        .review-card:last-child { border-bottom: none; }
        .review-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px; }
        .review-author { font-weight: 600; font-size: 14px; }
        .review-date { font-size: 12px; color: #6b7280; }
        .review-stars { display: flex; gap: 2px; margin-bottom: 8px; }
        .star { color: #fbbf24; font-size: 16px; }
        .star.empty { color: #d1d5db; }
        .review-text { font-size: 14px; color: #4b5563; line-height: 1.5; }
        .review-actions { display: flex; gap: 8px; margin-top: 8px; }
        
        .add-review { background: #f9fafb; padding: 16px; border-radius: 12px; margin-top: 16px; }
        .star-input { display: flex; gap: 8px; margin-bottom: 12px; }
        .star-btn { background: none; border: none; font-size: 24px; cursor: pointer; color: #d1d5db; transition: color 0.2s; }
        .star-btn.active { color: #fbbf24; }
        .star-btn:hover { color: #fbbf24; }
        
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 100; padding: 16px; }
        .modal-content { background: white; border-radius: 24px; padding: 32px; max-width: 400px; width: 100%; max-height: 90vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .modal-header h2 { font-size: 20px; font-weight: bold; }
        .modal-close { background: none; border: none; cursor: pointer; padding: 8px; }
        .modal-close svg { width: 24px; height: 24px; }
        
        .form-label { display: block; font-weight: 600; margin-bottom: 8px; font-size: 14px; }
        .form-input { width: 100%; padding: 12px 16px; border: 1px solid #e5e7eb; border-radius: 12px; font-size: 16px; outline: none; margin-bottom: 16px; }
        .form-input:focus { border-color: #059669; box-shadow: 0 0 0 2px rgba(5,150,105,0.2); }
        .form-textarea { width: 100%; padding: 12px 16px; border: 1px solid #e5e7eb; border-radius: 12px; font-size: 16px; min-height: 120px; resize: vertical; outline: none; font-family: inherit; margin-bottom: 16px; }
        .form-textarea:focus { border-color: #059669; box-shadow: 0 0 0 2px rgba(5,150,105,0.2); }
        
        .info-box { background: #ecfdf5; border: 1px solid #a7f3d0; border-radius: 12px; padding: 16px; margin-bottom: 16px; }
        .info-box.warning { background: #fef3c7; border-color: #fcd34d; }
        .info-box h4 { font-size: 14px; font-weight: 600; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
        .info-box p { font-size: 13px; color: #4b5563; line-height: 1.5; margin-bottom: 4px; }
        .info-box strong { color: #111827; }
        
        .bank-card-placeholder { width: 100%; height: 200px; border: 2px dashed #d1d5db; border-radius: 12px; display: flex; align-items: center; justify-content: center; background: #f9fafb; margin-top: 12px; }
        .bank-card-placeholder p { color: #6b7280; font-size: 14px; }
        
        .error-msg { color: #ef4444; font-size: 13px; margin-top: -12px; margin-bottom: 12px; }
        .success-msg { color: #059669; font-size: 13px; margin-bottom: 12px; }
        
        .spinner { width: 50px; height: 50px; border: 4px solid #e5e7eb; border-top-color: #059669; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .downloading { position: fixed; inset: 0; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 200; }
        .downloading-content { background: white; border-radius: 24px; padding: 32px; text-align: center; max-width: 300px; }
        .downloading-content h3 { margin: 16px 0 8px; font-size: 18px; }
        .downloading-content p { color: #6b7280; font-size: 14px; }
    </style>
</head>
<body>
    <div id="app"></div>
    <div id="downloadModal"></div>
    
    <script>
        // ========== FIREBASE REALTIME DATABASE ==========
        const FIREBASE_DB_URL = 'https://streamx-a4099-default-rtdb.firebaseio.com';
        
        // ========== HOURLY GRADIENT FOR APP NAME ==========
        function getHourlyGradient() {
            const hour = new Date().getHours();
            const gradients = [
                'linear-gradient(to right, #ef4444, #f97316)',
                'linear-gradient(to right, #f59e0b, #eab308)',
                'linear-gradient(to right, #84cc16, #22c55e)',
                'linear-gradient(to right, #10b981, #059669)',
                'linear-gradient(to right, #14b8a6, #06b6d4)',
                'linear-gradient(to right, #0ea5e9, #3b82f6)',
                'linear-gradient(to right, #6366f1, #8b5cf6)',
                'linear-gradient(to right, #a855f7, #d946ef)',
                'linear-gradient(to right, #ec4899, #f43f5e)',
                'linear-gradient(to right, #f43f5e, #ef4444)',
                'linear-gradient(to right, #fb923c, #fdba74)',
                'linear-gradient(to right, #34d399, #6ee7b7)',
                'linear-gradient(to right, #fde047, #facc15)',
                'linear-gradient(to right, #c084fc, #e879f9)',
                'linear-gradient(to right, #fb7185, #fda4af)',
                'linear-gradient(to right, #67e8f9, #a5f3fc)',
                'linear-gradient(to right, #fdba74, #fed7aa)',
                'linear-gradient(to right, #86efac, #bbf7d0)',
                'linear-gradient(to right, #fca5a5, #fecaca)',
                'linear-gradient(to right, #93c5fd, #bfdbfe)',
                'linear-gradient(to right, #c4b5fd, #ddd6fe)',
                'linear-gradient(to right, #f9a8d4, #fbcfe8)',
                'linear-gradient(to right, #fde68a, #fef3c7)',
                'linear-gradient(to right, #a78bfa, #c4b5fd)'
            ];
            return gradients[hour % gradients.length];
        }
        
        // ========== DAILY THEME COLORS ==========
        function getDailyColors() {
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
            const colorSets = [
                { primary: '#059669', secondary: '#0d9488', light: '#d1fae5' },
                { primary: '#3b82f6', secondary: '#2563eb', light: '#dbeafe' },
                { primary: '#8b5cf6', secondary: '#7c3aed', light: '#ede9fe' },
                { primary: '#ec4899', secondary: '#db2777', light: '#fce7f3' },
                { primary: '#f59e0b', secondary: '#d97706', light: '#fef3c7' },
                { primary: '#ef4444', secondary: '#dc2626', light: '#fee2e2' },
                { primary: '#14b8a6', secondary: '#0d9488', light: '#ccfbf1' }
            ];
            return colorSets[dayOfYear % colorSets.length];
        }
        
        const dailyColors = getDailyColors();
        
        function applyColors() {
            const hourlyGradient = getHourlyGradient();
            const style = document.createElement('style');
            style.id = 'dynamic-colors';
            style.innerHTML = `
                .logo { 
                    background: ${hourlyGradient} !important; 
                    -webkit-background-clip: text !important; 
                    -webkit-text-fill-color: transparent !important; 
                    background-clip: text !important; 
                }
                .btn:not(.btn-outline):not(.btn-danger), .cat-btn.active, .download-btn, .featured { 
                    background: linear-gradient(135deg, ${dailyColors.primary}, ${dailyColors.secondary}) !important; 
                }
                .nav-item.active, .detail-author { color: ${dailyColors.primary} !important; }
                .detail-cat, .app-badge { background: ${dailyColors.light} !important; color: ${dailyColors.primary} !important; }
                .form-input:focus, .form-textarea:focus { border-color: ${dailyColors.primary} !important; }
                .spinner { border-top-color: ${dailyColors.primary} !important; }
            `;
            
            const existing = document.getElementById('dynamic-colors');
            if (existing) existing.remove();
            document.head.appendChild(style);
        }
        
        // ========== ICONS ==========
        const icons = {
            search: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>',
            plus: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>',
            home: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>',
            upload: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>',
            user: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>',
            download: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>',
            smartphone: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>',
            book: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"/></svg>',
            music: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>',
            grid: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>',
            arrowLeft: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>',
            x: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>',
            star: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>',
            trash: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>',
            mail: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>',
            logOut: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>',
            messageSquare: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>',
            creditCard: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="14" x="2" y="5" rx="2"/><line x1="2" x2="22" y1="10" y2="10"/></svg>',
            alertCircle: '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>',
        };
        
        // ========== DEFAULT APPS (HORIZONTAL FORMAT) ==========
        const defaultApps = [
            { id: 'default_21', title: 'Home45', shortDesc: 'Buy or sell property easily with trusted marketing across South Africa.', description: 'Buy your new house from us with a 50% deposit, or sell your house on our platform. Selling fee is R1500 per property listed and includes daily marketing to attract serious buyers across South Africa.', category: 'app', downloadType: 'apk', downloadUrl: 'https://github.com/zapk1/beelzeapps/releases/download/V9/Home45.apk', iconUrl: 'https://i.postimg.cc/cHDwsJb8/Screenshot-20260209-172956-Chrome.jpg', screenshots: ['https://i.postimg.cc/DwmDFWp4/Screenshot-20260209-172058-Chrome.jpg','https://i.postimg.cc/y6PrZhwm/Screenshot-20260209-172202-Chrome.jpg','https://i.postimg.cc/y6PrZhwm/Screenshot-20260209-172202-Chrome.jpg'], author: 'Home45 Team', downloads: 3891, size: '2 MB', version: 'V1.0', isDefault: true, featured: true },
            { id: 'default_20', title: ' Dark Master Store ', shortDesc: 'Best online shopping app with free delivery everywhere around South Africa. ', description: ' We are an online shopping company registered with CIPC standing around South Africa preparing to sell legit products with free delivery around South Africa.', category: 'app', downloadType: 'apk', downloadUrl: 'https://github.com/zapk1/beelzeapps/releases/download/V8/Dark_Master_Store.apk', iconUrl: 'https://i.postimg.cc/x8DD1tL0/Screenshot-20260206-195153-Gallery.jpg', screenshots: ['https://i.postimg.cc/KvrrRr1f/Screenshot-20260206-231740-Chrome.jpg' , 'https://i.postimg.cc/v8vcnPvw/Screenshot-20260206-231807-Chrome.jpg','https://i.postimg.cc/CxKg27Dx/Screenshot-20260206-234856-Chrome.jpg'], author: 'Dark Master Store Sa Team', downloads: 2424, size: '1 MB', version: 'V1.0', isDefault: true, featured: true },
            { id: 'default_19', title: ' BeelzeApps', shortDesc: 'Modern simple App Store for storing and hosting little apps . ', description: 'Beelzeapps is a simple online App Store for People to host their apps such as Stores , Books , Music and others for free and we only charge R500 for apps above 11MB space ', category: 'app', downloadType: 'apk', downloadUrl: 'https://github.com/zapk1/beelzeapps/releases/download/V7/BeelzeApps.1.apk', iconUrl: 'https://i.postimg.cc/L5PsZ2vw/Screenshot-20260122-204929-com-google-android-youtube-edit-128026005216681.jpg', screenshots: ['https://i.postimg.cc/bNZnQVzs/Screenshot-20260123-024628-Chrome.jpg', 'https://i.postimg.cc/bNZnQVzs/Screenshot-20260123-024628-Chrome.jpg'], author: 'Beelze Apps Team', downloads: 2321424, size: '1 MB', version: 'V1.0', isDefault: true, featured: true },
               { id: 'default_18', title: ' StreamXNews', shortDesc: 'Latest news everyday ,and from different users globally around South Africa and Other Countries no racism. ', description: 'StreamXNews app was created by Beelze Apps team to help people share quick news to people and leave updates to their loved ones ,here is where everything spreads faster without paying any cent to be seen.', category: 'app', downloadType: 'apk', downloadUrl: 'https://github.com/zapk1/beelzeapps/releases/download/V6/StreamXNews.apk', iconUrl: 'https://i.postimg.cc/wxVR88B3/IMG-3684.png', screenshots: ['https://i.postimg.cc/KjV9vK5w/Screenshot-20260123-020856.jpg', 'https://i.postimg.cc/BQLY7gSQ/Screenshot-20260123-020942.jpg', 'https://i.postimg.cc/rFBhBrsR/Screenshot-20260123-020957.jpg'], author: 'Beelze Apps Team', downloads: 234132, size: '1 MB', version: 'V1.0', isDefault: true, featured: true },
              { id: 'default_17', title: ' ForexEdge', shortDesc: 'Trade predictable movements earn 250x Profit Potential return per deposit ', description: 'Forex Edge is here for you to Trade predictable movements earn 250x Profit Potential return per deposit', category: 'app', downloadType: 'apk', downloadUrl: 'https://github.com/zapk1/beelzeapps/releases/download/V4/FxEdge.apk', iconUrl: 'https://i.postimg.cc/SKsvqKjh/Screenshot-20260112-222555-Gallery.jpg', screenshots: ['https://i.postimg.cc/SQDYYNxg/Screenshot-20260112-222339-Chrome.jpg', 'https://i.postimg.cc/QN0KKxMM/Screenshot-20260112-222253-Chrome.jpg', 'https://i.postimg.cc/yYxgm4JV/Screenshot-20260112-222233-Chrome.jpg'], author: 'Beelze Apps Team', downloads: 544622, size: '7 MB', version: 'V1.0', isDefault: true, featured: true },
             { id: 'default_16', title: 'StreamX ', shortDesc: 'freedom, creativity, and real-time engagement', description: 'StreamX emphasizes user freedom, creativity, and real-time engagement, making it ideal for creators, influencers, and everyday users looking for a fresh, dynamic social experience.', category: 'app', downloadType: 'apk', downloadUrl: 'https://github.com/zapk1/beelzeapps/releases/download/V5/StreamX.1.apk', iconUrl: 'https://i.postimg.cc/4x0kBjzr/IMG-3460.png', screenshots: ['https://i.postimg.cc/fbvP2VQQ/Screenshot-20260111-074048-Chrome(1).jpg', 'https://i.postimg.cc/0Q09Ckcz/Screenshot-20260111-073955-Chrome.jpg', 'https://i.postimg.cc/fbvP2VQQ/Screenshot-20260111-074048-Chrome(1).jpg'], author: 'Beelze Apps Team', downloads: 3654622, size: '1 MB', version: 'V1.0', isDefault: true, featured: true },
            { id: 'default_15', title: 'BeelzeFlow', shortDesc: 'Scheduling Daily Tasks and Routines', description: 'Complete task management with reminders, scheduling, and productivity tracking. Stay organized and never miss a deadline.', category: 'app', downloadType: 'apk', downloadUrl: 'https://github.com/zapk1/beelzeapps/releases/download/V2.0/app-debug.apk', iconUrl: 'https://i.postimg.cc/ZqVbgNM6/blue-letter-made-wood.jpg', screenshots: ['https://i.postimg.cc/QxqY3kJL/screenshot1.png', 'https://i.postimg.cc/TYmH2nKL/screenshot2.png', 'https://i.postimg.cc/pXjN4kYL/screenshot3.png'], author: 'Beelze Apps Team', downloads: 322, size: '6 MB', version: 'V1.0', isDefault: true, featured: true },
            { id: 'default_1', title: 'WhatsApp Enhanced', shortDesc: 'Premium WhatsApp features unlocked', description: 'Enhanced WhatsApp with anti-delete messages, privacy controls, custom themes, and download status features.', category: 'app', downloadType: 'apk', downloadUrl: '', iconUrl: 'https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg', screenshots: ['https://i.postimg.cc/Sample1.png', 'https://i.postimg.cc/Sample2.png'], author: 'ModDev Team', downloads: 15420, size: '45 MB', version: '2.24.1', isDefault: true },
            { id: 'default_2', title: 'Spotify Premium', shortDesc: 'Unlimited music streaming', description: 'Ad-free music streaming with unlimited skips, offline downloads, and high-quality audio.', category: 'app', downloadType: 'apk', downloadUrl: '', iconUrl: 'https://upload.wikimedia.org/wikipedia/commons/1/19/Spotify_logo_without_text.svg', screenshots: ['https://i.postimg.cc/Sample3.png', 'https://i.postimg.cc/Sample4.png'], author: 'Premium Mods', downloads: 28930, size: '32 MB', version: '8.9.0', isDefault: true },
            { id: 'default_3', title: 'Instagram Pro', shortDesc: 'Download photos and videos', description: 'Save Instagram photos, videos, stories, and reels directly to your device. No watermarks.', category: 'app', downloadType: 'apk', downloadUrl: '', iconUrl: 'https://upload.wikimedia.org/wikipedia/commons/e/e7/Instagram_logo_2016.svg', screenshots: ['https://i.postimg.cc/Sample5.png'], author: 'InstaTeam', downloads: 42100, size: '58 MB', version: '4.2.0', isDefault: true },
            { id: 'default_4', title: 'YouTube Vanced', shortDesc: 'Ad-free YouTube', description: 'YouTube without ads, with background playback, SponsorBlock, and picture-in-picture mode.', category: 'app', downloadType: 'apk', downloadUrl: '', iconUrl: 'https://upload.wikimedia.org/wikipedia/commons/0/09/YouTube_full-color_icon_%282017%29.svg', screenshots: [], author: 'Vanced Team', downloads: 89200, size: '78 MB', version: '18.45.1', isDefault: true },
            { id: 'default_5', title: 'Rich Dad Poor Dad', shortDesc: 'Financial education classic', description: 'What the Rich Teach Their Kids About Money That the Poor and Middle Class Do Not!', category: 'book', downloadType: 'pdf', downloadUrl: '', iconUrl: 'https://i.postimg.cc/2S9bTjc2/download-(3).webp', screenshots: [], author: 'Robert Kiyosaki', downloads: 12500, size: '2.4 MB', version: '1.0', isDefault: true },
            { id: 'default_6', title: 'The 48 Laws of Power', shortDesc: 'Master strategy and influence', description: 'An essential guide to power and strategy. Learn the timeless principles used by history\'s greatest leaders.', category: 'book', downloadType: 'pdf', downloadUrl: '', iconUrl: 'https://images-na.ssl-images-amazon.com/images/I/71aG+xDKSYL.jpg', screenshots: [], author: 'Robert Greene', downloads: 18700, size: '3.1 MB', version: '1.0', isDefault: true },
            { id: 'default_7', title: 'Think and Grow Rich', shortDesc: 'The success philosophy', description: 'Napoleon Hill\'s timeless classic on personal achievement and wealth building.', category: 'book', downloadType: 'pdf', downloadUrl: '', iconUrl: 'https://images-na.ssl-images-amazon.com/images/I/71UypkUjStL.jpg', screenshots: [], author: 'Napoleon Hill', downloads: 9800, size: '1.8 MB', version: '1.0', isDefault: true },
            { id: 'default_8', title: 'Chill Lofi Beats Mix', shortDesc: 'Relaxing study music', description: 'Perfect lofi hip-hop beats collection for studying, working, or relaxing.', category: 'music', downloadType: 'audio', downloadUrl: '', iconUrl: 'https://i.postimg.cc/rFC5GkLV/download.webp', screenshots: [], author: 'ChillBeats', downloads: 5600, size: '45 MB', version: '1.0', isDefault: true },
            { id: 'default_9', title: 'Motivation Collection', shortDesc: 'Powerful speeches', description: 'The best motivational speeches from top speakers worldwide.', category: 'music', downloadType: 'audio', downloadUrl: '', iconUrl: 'https://i.postimg.cc/wjQFBNB7/download-(1).webp', screenshots: [], author: 'MotivateMe', downloads: 3200, size: '28 MB', version: '1.0', isDefault: true },
            { id: 'default_10', title: 'TikTok Downloader', shortDesc: 'Save videos without watermark', description: 'Download TikTok videos directly to your device without watermarks.', category: 'app', downloadType: 'apk', downloadUrl: '', iconUrl: 'https://upload.wikimedia.org/wikipedia/en/a/a9/TikTok_logo.svg', screenshots: [], author: 'TikMod', downloads: 67800, size: '92 MB', version: '32.1.5', isDefault: true }
        ];
        
        // ========== STATE ==========
        let dbApps = [];
        let currentUser = null;
        let currentPage = 'home';
        let currentCategory = 'all';
        let searchQuery = '';
        let selectedAppId = null;
        let downloadedApps = JSON.parse(localStorage.getItem('beelze_downloaded_apps') || '[]');
        let selectedRating = 5;
        
        // ========== UTILITIES ==========
        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return (num || 0).toString();
        }
        
        function getCategoryIcon(cat) {
            if (cat === 'app') return icons.smartphone;
            if (cat === 'book') return icons.book;
            if (cat === 'music') return icons.music;
            return icons.grid;
        }
        
        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }
        
        function getAllApps() {
            const defaults = shuffleArray(defaultApps.filter(a => !a.featured));
            const featured = defaultApps.filter(a => a.featured);
            const db = shuffleArray(dbApps);
            return [...featured, ...defaults, ...db];
        }
        
        function getFeaturedApp() {
            const featured = defaultApps.filter(a => a.featured);
            if (featured.length === 0) return getAllApps()[0];
            const hour = new Date().getHours();
            return featured[hour % featured.length];
        }
        
        // ========== FIREBASE ==========
        async function loadAppsFromDB() {
            try {
                const response = await fetch(`${FIREBASE_DB_URL}/beelzeApps.json`);
                if (!response.ok) {
                    console.log('Firebase returned error, using defaults only');
                    dbApps = [];
                    render();
                    return;
                }
                const data = await response.json();
                if (data && typeof data === 'object') {
                    dbApps = Object.keys(data).map(key => ({ id: key, ...data[key] }));
                } else {
                    dbApps = [];
                }
                render();
            } catch (e) {
                console.error('Error loading from DB:', e);
                dbApps = [];
                render();
            }
        }
        
        async function updateAppInDB(appId, data) {
            try {
                await fetch(`${FIREBASE_DB_URL}/beelzeApps/${appId}.json`, {
                    method: 'PATCH',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
            } catch (e) {
                console.error(e);
            }
        }
        
        // ========== DOWNLOAD TRACKING ==========
        async function trackDownload(appId) {
            if (downloadedApps.includes(appId)) return false;
            downloadedApps.push(appId);
            localStorage.setItem('beelze_downloaded_apps', JSON.stringify(downloadedApps));
            
            const app = getAllApps().find(a => a.id === appId);
            if (!app || app.isDefault) return true;
            
            try {
                const newCount = (app.downloads || 0) + 1;
                await updateAppInDB(appId, { downloads: newCount });
                await loadAppsFromDB();
            } catch (e) {
                console.error(e);
            }
            return true;
        }
        
              // ========== DOWNLOAD - FIXED ==========
        async function downloadApp(id) {
            const allApps = getAllApps();
            const app = allApps.find(a => a.id === id);
            if (!app) return;
            
            // Update download count for DB apps
            if (!app.isDefault && app.id) {
                const newCount = (app.downloads || 0) + 1;
                try {
                    await updateAppInDB(app.id, { downloads: newCount });
                    const dbApp = dbApps.find(a => a.id === app.id);
                    if (dbApp) dbApp.downloads = newCount;
                    render();
                } catch (e) { console.error(e); }
            }
            
        
            if (app.downloadUrl) {
                window.open(app.downloadUrl, '_blank');
                return;
            }
            
            if (app.isDefault) {
                alert('This is a demo app. Download link not available.');
                return;
            }
            
            alert('Download functionality for uploaded files coming soon!');
        }
        
        // ========== REVIEWS ==========
        async function loadReviews(appId) {
            try {
                const response = await fetch(`${FIREBASE_DB_URL}/appReviews/${appId}.json`);
                const data = await response.json();
                return data ? Object.keys(data).map(k => ({ id: k, ...data[k] })) : [];
            } catch (e) {
                console.error(e);
                return [];
            }
        }
        
        async function addReview(appId, rating, text) {
            if (!currentUser) {
                alert('Please sign in to leave a review');
                return;
            }
            
            try {
                await fetch(`${FIREBASE_DB_URL}/appReviews/${appId}.json`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: currentUser.email,
                        userEmail: currentUser.email,
                        rating,
                        text,
                        timestamp: Date.now()
                    })
                });
                render();
            } catch (e) {
                alert('Failed to add review: ' + e.message);
            }
        }
        
        async function deleteReview(appId, reviewId) {
            try {
                await fetch(`${FIREBASE_DB_URL}/appReviews/${appId}/${reviewId}.json`, {
                    method: 'DELETE'
                });
                render();
            } catch (e) {
                alert('Failed to delete review: ' + e.message);
            }
        }
        
        // ========== AUTH ==========
        function showAuthModal(isSignUp = false) {
            const modal = document.createElement('div');
            modal.id = 'authModal';
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>${isSignUp ? 'Create Account' : 'Sign In'}</h2>
                        <button class="modal-close" onclick="closeAuthModal()">${icons.x}</button>
                    </div>
                    <form onsubmit="handleAuth(event, ${isSignUp})">
                        <label class="form-label">Email</label>
                        <input type="email" name="email" class="form-input" required>
                        <label class="form-label">Password</label>
                        <input type="password" name="password" class="form-input" minlength="6" required>
                        <div id="authError" class="error-msg" style="display:none;"></div>
                        <button type="submit" class="btn" style="width:100%;justify-content:center;">${isSignUp ? 'Sign Up' : 'Sign In'}</button>
                    </form>
                    <p style="text-align:center;margin-top:16px;font-size:14px;color:#6b7280;">
                        ${isSignUp ? 'Already have an account?' : "Don't have an account?"}
                        <a href__="#" onclick="closeAuthModal();showAuthModal(${!isSignUp});return false;" style="color:${dailyColors.primary};font-weight:500;">${isSignUp ? 'Sign In' : 'Sign Up'}</a>
                    </p>
                    <p style="text-align:center;margin-top:8px;">
                        <a href__="#" onclick="showForgotPassword();return false;" style="color:${dailyColors.primary};font-size:13px;">Forgot Password?</a>
                    </p>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function closeAuthModal() {
            const modal = document.getElementById('authModal');
            if (modal) modal.remove();
        }
        
        async function handleAuth(e, isSignUp) {
            e.preventDefault();
            const email = e.target.email.value;
            const password = e.target.password.value;
            const errorDiv = document.getElementById('authError');
            
            try {
                const usersResponse = await fetch(`${FIREBASE_DB_URL}/beelzeUsers.json`);
                const users = await usersResponse.json() || {};
                const userKey = email.replace(/\./g, '_');
                
                if (isSignUp) {
                    if (users[userKey]) {
                        errorDiv.style.display = 'block';
                        errorDiv.textContent = 'This email is already registered. Please sign in instead.';
                        return;
                    }
                    
                    await fetch(`${FIREBASE_DB_URL}/beelzeUsers/${userKey}.json`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email, password, createdDate: new Date().toISOString() })
                    });
                    
                    currentUser = { email };
                    closeAuthModal();
                    render();
                } else {
                    const user = users[userKey];
                    if (!user || user.password !== password) {
                        errorDiv.style.display = 'block';
                        errorDiv.textContent = 'Invalid email or password.';
                        return;
                    }
                    
                    currentUser = { email };
                    closeAuthModal();
                    render();
                }
            } catch (error) {
                errorDiv.style.display = 'block';
                errorDiv.textContent = error.message;
            }
        }
        
        function showForgotPassword() {
            closeAuthModal();
            alert('Password reset: Please contact support at ngwepelk885@gmail.com with your registered email to reset your password.');
        }
        
        function logout() {
            currentUser = null;
            navigateTo('home');
        }
        
        // ========== UPLOAD INFO ==========
        function showUploadInfo() {
            if (!currentUser) {
                showAuthModal(false);
                return;
            }
            
            const modal = document.createElement('div');
            modal.id = 'uploadModal';
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Upload Your App</h2>
                        <button class="modal-close" onclick="closeUploadModal()">${icons.x}</button>
                    </div>
                    
                    <div class="info-box">
                        <h4>${icons.alertCircle} Free Upload (Up to 10MB)</h4>
                        <p>Files under 10MB can be uploaded directly through our platform for <strong>FREE</strong>!</p>
                    </div>
                    
                    <div class="info-box warning">
                        <h4>${icons.alertCircle} Large Files (Over 10MB)</h4>
                        <p>For apps larger than 10MB, please follow these steps:</p>
                        <p><strong>1.</strong> Send your APK file, icon, screenshots, and app details to:</p>
                        <p style="margin:8px 0;padding:12px;background:white;border-radius:8px;font-weight:600;">ngwepelk885@gmail.com</p>
                        <p><strong>2.</strong> Payment: R500 per app</p>
                        <p><strong>3.</strong> Your app will stay on our platform <strong>permanently</strong></p>
                    </div>
                    
                    <div class="section">
                        <h4 style="margin-bottom:12px;">${icons.creditCard} Payment Details</h4>
                        <div class="bank-card-placeholder">
                            <p>Bank card image will be displayed here</p>
                        </div>
                    </div>
                    
                    <button class="btn" style="width:100%;justify-content:center;" onclick="closeUploadModal()">Got It</button>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function closeUploadModal() {
            const modal = document.getElementById('uploadModal');
            if (modal) modal.remove();
        }
        
        // ========== NAVIGATION ==========
        function navigateTo(page) {
            currentPage = page;
            render();
            window.scrollTo(0, 0);
        }
        
        function setCategory(cat) {
            currentCategory = cat;
            render();
        }
        
        function handleSearch(value) {
            searchQuery = value || '';
            render();
        }
        
        function viewApp(id) {
            selectedAppId = id;
            currentPage = 'detail';
            render();
            window.scrollTo(0, 0);
        }
        
        function viewScreenshot(url) {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.onclick = () => modal.remove();
            modal.innerHTML = `
                <div style="max-width:90%;max-height:90vh;">
                    <img src="${url}" style="max-width:100%;max-height:90vh;border-radius:12px;">
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function setRating(rating) {
            selectedRating = rating;
            document.querySelectorAll('.star-btn').forEach((btn, i) => {
                btn.classList.toggle('active', i < rating);
            });
        }
        
        async function submitReview(appId) {
            const text = document.getElementById('reviewText').value.trim();
            if (!text) {
                alert('Please write a review');
                return;
            }
            await addReview(appId, selectedRating, text);
            document.getElementById('reviewText').value = '';
            setRating(5);
        }
        
        // ========== RENDER ==========
        function renderBottomNav() {
            return `
                <nav class="bottom-nav">
                    <div class="nav-content">
                        <button class="nav-item ${currentPage === 'home' || currentPage === 'detail' ? 'active' : ''}" onclick="navigateTo('home')">
                            ${icons.home}
                            <span>Home</span>
                        </button>
                        <button class="nav-item" onclick="showUploadInfo()">
                            ${icons.upload}
                            <span>Upload</span>
                        </button>
                        <button class="nav-item ${currentPage === 'profile' ? 'active' : ''}" onclick="navigateTo('profile')">
                            ${currentUser ? `<div class="nav-avatar">${currentUser.email[0].toUpperCase()}</div>` : icons.user}
                            <span>Profile</span>
                        </button>
                    </div>
                </nav>
            `;
        }
        
        function renderHome() {
            const allApps = getAllApps();
            const query = searchQuery.toLowerCase().trim();
            const filtered = allApps.filter(app => {
                const matchesCat = currentCategory === 'all' || app.category === currentCategory;
                if (!query) return matchesCat;
                const matchesSearch = (app.title || '').toLowerCase().includes(query) ||
                                     (app.description || '').toLowerCase().includes(query);
                return matchesCat && matchesSearch;
            });
            
            const featured = getFeaturedApp();
            
            return `
                <header class="header">
                    <div class="header-content">
                        <div class="header-top">
                            <div>
                                <div class="logo">Beelze Apps</div>
                                <div class="logo-sub">Your alternative app store</div>
                            </div>
                            <button class="btn" onclick="showUploadInfo()">${icons.plus} Upload</button>
                        </div>
                        <div class="search-box">
                            ${icons.search}
                            <input type="text" class="search-input" placeholder="Search apps..." value="${searchQuery}" oninput="handleSearch(this.value)">
                        </div>
                    </div>
                </header>
                
                <div class="categories">
                    <button class="cat-btn ${currentCategory === 'all' ? 'active' : ''}" onclick="setCategory('all')">${icons.grid} All</button>
                    <button class="cat-btn ${currentCategory === 'app' ? 'active' : ''}" onclick="setCategory('app')">${icons.smartphone} Apps</button>
                    <button class="cat-btn ${currentCategory === 'book' ? 'active' : ''}" onclick="setCategory('book')">${icons.book} Books</button>
                    <button class="cat-btn ${currentCategory === 'music' ? 'active' : ''}" onclick="setCategory('music')">${icons.music} Music</button>
                </div>
                
                <main class="main">
                    ${!query && currentCategory === 'all' && featured ? `
                        <div class="featured" onclick="viewApp('${featured.id}')">
                            <div class="featured-content">
                                <img src="${featured.iconUrl}" class="featured-icon" alt="${featured.title}">
                                <div style="flex:1;">
                                    <span class="featured-badge">Featured</span>
                                    <h2 class="featured-title">${featured.title}</h2>
                                    <p class="featured-desc">${featured.shortDesc}</p>
                                    <div class="featured-stats">
                                        <span style="display:flex;align-items:center;gap:4px;">${icons.download} ${formatNumber(featured.downloads)}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                    
                    ${filtered.map(app => `
                        <div class="app-card" onclick="viewApp('${app.id}')">
                            <div class="app-icon-wrap">
                                <img src="${app.iconUrl}" class="app-icon" alt="${app.title}">
                                <div class="app-badge">${getCategoryIcon(app.category)}</div>
                            </div>
                            <div class="app-info">
                                <div class="app-title">${app.title}</div>
                                <div class="app-author">${app.author}</div>
                                <div class="app-desc">${app.shortDesc}</div>
                                <div class="app-stats">
                                    <span style="display:flex;align-items:center;gap:4px;">${icons.download} ${formatNumber(app.downloads)}</span>
                                    ${app.size ? `<span>${app.size}</span>` : ''}
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </main>
                ${renderBottomNav()}
            `;
        }
        
        async function renderDetail() {
            const app = getAllApps().find(a => a.id === selectedAppId);
            if (!app) return renderHome();
            
            const reviews = await loadReviews(app.id);
            const avgRating = reviews.length > 0 ? (reviews.reduce((sum, r) => sum + r.rating, 0) / reviews.length).toFixed(1) : 0;
            
            return `
                <header class="header">
                    <div class="header-content">
                        <div style="display:flex;align-items:center;gap:16px;">
                            <button onclick="navigateTo('home')" style="background:none;border:none;padding:8px;cursor:pointer;">${icons.arrowLeft}</button>
                            <h1 style="font-weight:600;flex:1;overflow:hidden;text-overflow:ellipsis;">${app.title}</h1>
                        </div>
                    </div>
                </header>
                
                <main class="main" style="padding-top:24px;">
                    <div class="detail-card">
                        <div class="detail-top">
                            <img src="${app.iconUrl}" class="detail-icon" alt="${app.title}">
                            <div style="flex:1;">
                                <h2 class="detail-title">${app.title}</h2>
                                <p class="detail-author">${app.author}</p>
                                <span class="detail-cat">${getCategoryIcon(app.category)} ${app.category}</span>
                            </div>
                        </div>
                        <div class="detail-stats">
                            <div class="stat"><div class="stat-val">${icons.download} ${formatNumber(app.downloads)}</div><div class="stat-label">Downloads</div></div>
                            <div class="stat"><div class="stat-val">${app.size || 'N/A'}</div><div class="stat-label">Size</div></div>
                            <div class="stat"><div class="stat-val">${avgRating} </div><div class="stat-label">Rating</div></div>
                        </div>
                        <button class="download-btn" onclick="downloadApp('${app.id}')">
                            ${icons.download} Download
                        </button>
                    </div>
                    
                    ${app.screenshots && app.screenshots.length > 0 ? `
                        <div style="margin-bottom:24px;">
                            <h3 class="section-title">Screenshots</h3>
                            <div class="screenshots">
                                ${app.screenshots.map(s => `<img src="${s}" class="screenshot" alt="Screenshot" onclick="viewScreenshot('${s}')">`).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="section">
                        <h3 class="section-title">About</h3>
                        <p class="section-text">${app.description}</p>
                    </div>
                    
                    <div class="reviews-section">
                        <h3 class="section-title">${icons.messageSquare} Reviews (${reviews.length})</h3>
                        
                        ${reviews.map(review => `
                            <div class="review-card">
                                <div class="review-header">
                                    <span class="review-author">${review.userEmail.split('@')[0]}</span>
                                    <span class="review-date">${new Date(review.timestamp).toLocaleDateString()}</span>
                                </div>
                                <div class="review-stars">
                                    ${[1,2,3,4,5].map(i => `<span class="star ${i <= review.rating ? '' : 'empty'}"></span>`).join('')}
                                </div>
                                <p class="review-text">${review.text}</p>
                                ${currentUser && review.userEmail === currentUser.email ? `
                                    <div class="review-actions">
                                        <button class="btn btn-danger" style="padding:4px 12px;" onclick="deleteReview('${app.id}', '${review.id}')">${icons.trash} Delete</button>
                                    </div>
                                ` : ''}
                            </div>
                        `).join('')}
                        
                        <div class="add-review">
                            <h4 style="margin-bottom:12px;">Write a Review</h4>
                            <div class="star-input" id="starInput">
                                ${[1,2,3,4,5].map(i => `<button type="button" class="star-btn ${i <= selectedRating ? 'active' : ''}" data-rating="${i}" onclick="setRating(${i})"></button>`).join('')}
                            </div>
                            <textarea id="reviewText" class="form-textarea" placeholder="Share your thoughts..."></textarea>
                            <button class="btn" onclick="submitReview('${app.id}')">Post Review</button>
                        </div>
                    </div>
                </main>
                ${renderBottomNav()}
            `;
        }
        
        function renderProfile() {
            if (!currentUser) {
                return `
                    <div style="min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:16px;">
                        <div style="background:white;border-radius:24px;padding:32px;max-width:400px;width:100%;text-align:center;">
                            <div style="width:64px;height:64px;background:#d1fae5;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 16px;">${icons.user}</div>
                            <h2 style="font-size:20px;font-weight:bold;margin-bottom:8px;">Sign In Required</h2>
                            <p style="color:#6b7280;margin-bottom:24px;">Sign in to view your profile and uploads</p>
                            <button class="btn" style="width:100%;justify-content:center;" onclick="showAuthModal(false)">Sign In</button>
                        </div>
                    </div>
                    ${renderBottomNav()}
                `;
            }
            
            const myApps = dbApps.filter(a => a.authorEmail === currentUser.email);
            const totalDownloads = myApps.reduce((sum, a) => sum + (a.downloads || 0), 0);
            
            return `
                <header class="header">
                    <div class="header-content">
                        <h1 style="font-weight:600;">My Profile</h1>
                    </div>
                </header>
                
                <main class="main" style="padding-top:24px;">
                    <div class="section">
                        <div style="display:flex;align-items:center;gap:16px;margin-bottom:24px;">
                            <div class="nav-avatar" style="width:64px;height:64px;font-size:24px;">${currentUser.email[0].toUpperCase()}</div>
                            <div>
                                <h2 style="font-weight:600;font-size:18px;">${currentUser.email}</h2>
                                <p style="font-size:14px;color:#6b7280;">Member</p>
                            </div>
                        </div>
                        
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:24px;">
                            <div style="background:#f9fafb;padding:16px;border-radius:12px;text-align:center;">
                                <div style="font-size:24px;font-weight:bold;">${myApps.length}</div>
                                <div style="font-size:14px;color:#6b7280;">Uploads</div>
                            </div>
                            <div style="background:#f9fafb;padding:16px;border-radius:12px;text-align:center;">
                                <div style="font-size:24px;font-weight:bold;">${formatNumber(totalDownloads)}</div>
                                <div style="font-size:14px;color:#6b7280;">Downloads</div>
                            </div>
                        </div>
                        
                        <button class="btn btn-outline" style="width:100%;justify-content:center;" onclick="logout()">${icons.logOut} Sign Out</button>
                    </div>
                    
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;">
                        <h3 style="font-size:18px;font-weight:600;">My Uploads</h3>
                        <button class="btn" onclick="showUploadInfo()">${icons.plus} Upload</button>
                    </div>
                    
                    ${myApps.length > 0 ? myApps.map(app => `
                        <div class="app-card" onclick="viewApp('${app.id}')">
                            <div class="app-icon-wrap">
                                <img src="${app.iconUrl}" class="app-icon" alt="${app.title}">
                            </div>
                            <div class="app-info">
                                <div class="app-title">${app.title}</div>
                                <div class="app-stats">
                                    <span style="display:flex;align-items:center;gap:4px;">${icons.download} ${formatNumber(app.downloads || 0)}</span>
                                </div>
                            </div>
                        </div>
                    `).join('') : `
                        <div class="section" style="text-align:center;padding:40px;">
                            <div class="empty-icon" style="margin:0 auto 16px;">${icons.upload}</div>
                            <h3>No uploads yet</h3>
                            <button class="btn" onclick="showUploadInfo()" style="margin-top:16px;">${icons.plus} Upload Your First App</button>
                        </div>
                    `}
                </main>
                ${renderBottomNav()}
            `;
        }
        
        function render() {
            let html = '';
            if (currentPage === 'detail') {
                renderDetail().then(h => document.getElementById('app').innerHTML = h);
            } else if (currentPage === 'profile') {
                html = renderProfile();
                document.getElementById('app').innerHTML = html;
            } else {
                html = renderHome();
                document.getElementById('app').innerHTML = html;
            }
        }
        
        // ========== INIT ==========
        applyColors();
        setInterval(applyColors, 60000);
        render();
        loadAppsFromDB();
    </script>
</body>
</html>
